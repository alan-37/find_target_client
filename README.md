# üöó Find Target Client ‚Äî –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –Ω–∞ —Å–∞–π—Ç–µ ¬´–°–±–µ—Ä–ê–≤—Ç–æ–ø–æ–¥–ø–∏—Å–∫–∞¬ª

> **–§–∏–Ω–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ø–æ –∞–Ω–∞–ª–∏–∑—É –∏ ML –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –±–∏–∑–Ω–µ—Å-–∫–µ–π—Å–∞ –æ—Ç –ø–∞—Ä—Ç–Ω—ë—Ä–∞ ‚Äî ¬´–°–±–µ—Ä–ê–≤—Ç–æ–ø–æ–¥–ø–∏—Å–∫–∞¬ª**

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ —Ä–µ—à–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω–æ–π –±–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á–∏: **–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —Å–æ–≤–µ—Ä—à–µ–Ω–∏—è —Ü–µ–ª–µ–≤–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –Ω–∞ —Å–∞–π—Ç–µ** ¬´–°–±–µ—Ä–ê–≤—Ç–æ–ø–æ–¥–ø–∏—Å–∫–∞¬ª.  
–ù–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö Google Analytics –º—ã —Å—Ç—Ä–æ–∏–º –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã—è–≤–ª—è—Ç—å "–≥–æ—Ä—è—á–∏—Ö" –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚Äî —Ç–µ—Ö, –∫—Ç–æ —Å –≤—ã—Å–æ–∫–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é –æ—Å—Ç–∞–≤–∏—Ç –∑–∞—è–≤–∫—É, –∑–∞–∫–∞–∂–µ—Ç –∑–≤–æ–Ω–æ–∫ –∏–ª–∏ —Å–æ–≤–µ—Ä—à–∏—Ç –¥—Ä—É–≥–æ–µ —Ü–µ–ª–µ–≤–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ.

---

## üìå –ó–∞–¥–∞—á–∞

**–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞** ‚Äî —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å ML-–º–æ–¥–µ–ª—å, —Å–ø–æ—Å–æ–±–Ω—É—é —Å —Ö–æ—Ä–æ—à–µ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å, —Å–æ–≤–µ—Ä—à–∏—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å **—Ü–µ–ª–µ–≤–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ** –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ –≤–∏–∑–∏—Ç–∞ (—Å–µ—Å—Å–∏–∏).

### –ß—Ç–æ —Å—á–∏—Ç–∞–µ—Ç—Å—è —Ü–µ–ª–µ–≤—ã–º –¥–µ–π—Å—Ç–≤–∏–µ–º?
–°–æ–±—ã—Ç–∏—è –∏–∑ `ga_hits.event_action`, –≤–∫–ª—é—á–∞—è:
- `sub_car_claim_click`
- `sub_car_claim_submit_click`
- `sub_open_dialog_click`
- `sub_custom_question_submit_click`
- `sub_call_number_click`
- `sub_callback_submit_click`
- `sub_submit_success`
- `sub_car_request_submit_click`

**–ö–æ–Ω–≤–µ—Ä—Å–∏—è (CR)** ‚Äî –Ω–∞–ª–∏—á–∏–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ–≥–æ —Ç–∞–∫–æ–≥–æ —Å–æ–±—ã—Ç–∏—è –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–π —Å–µ—Å—Å–∏–∏ (`session_id`).

---

## üß© –î–∞–Ω–Ω—ã–µ

–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–≤–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ –∏–∑ Google Analytics (last-click attribution):

### 1. `ga_sessions.csv` ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–∏–∑–∏—Ç–∞—Ö
| –ü–æ–ª–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|---------|
| `session_id` | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —Å–µ—Å—Å–∏–∏ |
| `client_id` | ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `visit_date`, `visit_time` | –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –≤–∏–∑–∏—Ç–∞ |
| `utm_source`, `utm_medium`, `utm_campaign`, `utm_keyword` | –ú–µ—Ç–∫–∏ —Ä–µ–∫–ª–∞–º—ã |
| `device_category`, `device_os`, `device_browser` | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ |
| `geo_country`, `geo_city` | –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è |
| `device_brand`, `device_model`, `device_screen_resolution` | –î–µ—Ç–∞–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ |

### 2. `ga_hits-001.csv` ‚Äî —Å–æ–±—ã—Ç–∏—è –≤ —Ä–∞–º–∫–∞—Ö —Å–µ—Å—Å–∏–π
| –ü–æ–ª–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|---------|
| `session_id` | –°—Å—ã–ª–∫–∞ –Ω–∞ –≤–∏–∑–∏—Ç |
| `hit_date`, `hit_time` | –í—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è |
| `hit_type`, `hit_page_path` | –¢–∏–ø –∏ URL —Å—Ç—Ä–∞–Ω–∏—Ü—ã |
| `event_category`, `event_action`, `event_label` | –ö–∞—Ç–µ–≥–æ—Ä–∏—è –∏ —Ç–∏–ø –¥–µ–π—Å—Ç–≤–∏—è |
| `event_value` | –ß–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–µ—Å–ª–∏ –µ—Å—Ç—å) |

---

## üöÄ –†–µ—à–µ–Ω–∏–µ

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

1. **pipeline.py** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
2. **main.py** ‚Äî API –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏

### –≠—Ç–∞–ø—ã —Ä–∞–±–æ—Ç—ã:

1. **–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**  
   –°–µ—Å—Å–∏–∏ –∏–∑ `ga_sessions.csv` –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è —Å —Å–æ–±—ã—Ç–∏—è–º–∏ –∏–∑ `ga_hits-001.csv` –ø–æ `session_id`.

2. **–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π**  
   –î–ª—è –∫–∞–∂–¥–æ–π —Å–µ—Å—Å–∏–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è `target = 1`, –µ—Å–ª–∏ –±—ã–ª–æ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ —Ü–µ–ª–µ–≤–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ, –∏–Ω–∞—á–µ `0`.

3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö**  
   - –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–Ω—É–∂–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫ –∏ –∑–Ω–∞—á–µ–Ω–∏–π
   - –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–∞
   - –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞ (–æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏–π/–ø–ª–∞—Ç–Ω—ã–π)
   - –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ device_os
   - –°–æ–∑–¥–∞–Ω–∏–µ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

4. **–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏**  
   - –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∞–ª–≥–æ—Ä–∏—Ç–º—ã: `Logistic Regression`, `Random Forest`, `XGBoost`, `CatBoost`
   - –ú–µ—Ç—Ä–∏–∫–∞: **ROC-AUC**, –æ—Ä–∏–µ–Ω—Ç–∏—Ä ‚Äî **~0.65**
   - –í–∞–ª–∏–¥–∞—Ü–∏—è: 3-–∫—Ä–∞—Ç–Ω–∞—è –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è

5. **–°–µ—Ä–≤–∏—Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è**  
   - –ú–æ–¥–µ–ª—å —É–ø–∞–∫–æ–≤–∞–Ω–∞ –≤ FastAPI
   - –ü—Ä–∏–Ω–∏–º–∞–µ—Ç JSON —Å –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏ —Å–µ—Å—Å–∏–∏
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `prediction: 0|1`

---

## üõ†Ô∏è –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
git clone https://github.com/alan-37/find_target_client.git
cd find_target_client 
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
pip install -r requirements.txt 
```

### 3. –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
–ü–æ–º–µ—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª—ã (https://drive.google.com/drive/folders/1rA4o6KHH-M2KMvBLHp5DZ5gioF2q7hZw) —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ –ø–∞–ø–∫—É data/:

data/ga_sessions.csv
data/ga_hits-001.csv

### 4. –û–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å
```bash
python pipeline.py
```
–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª—å –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ model/event_action.dill

### 5. –ó–∞–ø—É—Å—Ç–∏—Ç—å API (–ª–æ–∫–∞–ª—å–Ω–æ)

```bash
uvicorn main:app --reload --port 8000
```
–°–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ http://localhost:8000

–î–æ—Å—Ç—É–ø–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:
- GET /status ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä–≤–∏—Å–∞
- GET /version ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–æ–¥–µ–ª–∏
- POST /predict ‚Äî –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏

–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ –∫ /predict:
```JSON
{
  "utm_source": "google",
  "utm_medium": "cpc",
  "utm_campaign": "autoloan",
  "utm_adcontent": "some_content",
  "utm_keyword": "car_subscription",
  "device_category": "desktop",
  "device_os": "Windows",
  "device_brand": "HP",
  "device_browser": "Chrome",
  "device_screen_resolution": "1920x1080",
  "geo_country": "Russia",
  "geo_city": "–ú–æ—Å–∫–≤–∞",
  "visit_date": "2018-01-01",
  "visit_number": 1
}
```
–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:
```JSON
{
   "target": 1
}
```
# üìä –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –º–æ–¥–µ–ª–∏
–í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –∏–∑:

- Logistic Regression
- Random Forest
- CatBoost
- XGBoost

–ú–µ—Ç—Ä–∏–∫–∞ –æ—Ü–µ–Ω–∫–∏: ROC-AUC

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –ª—É—á—à–∞—è –º–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ model/event_action.dill —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏, –≤–∫–ª—é—á–∞—è –¥–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–π ROC-AUC. 
